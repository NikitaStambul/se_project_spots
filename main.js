!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitBtnSelector:".modal__submit-btn",errorSelector:".modal__error",inputTypeErrorClass:"modal__input_type_error",errorActiveClass:"modal__error_active",inactiveSubmitBtnClass:"modal__submit-btn_inactive"};function o(e,t,o){Array.from(e).some((e=>!e.validity.valid))?r(t,o):function(e,t){e.classList.remove(t.inactiveSubmitBtnClass),e.disabled=!1}(t,o)}function n(e,t){const o=e.parentElement.querySelector(t.errorSelector);e.classList.remove(t.inputTypeErrorClass),o.classList.remove(t.errorActiveClass)}function r(e,t){e.classList.add(t.inactiveSubmitBtnClass),e.disabled=!0}var c=e+"8650253b58b46f0f1c06.svg",s=e+"2fc47fd8e9a9bcd9612f.jpg";document.getElementById("logo").src=c,document.getElementById("avatar").src=s;const a=document.querySelector(".cards__list"),l=document.querySelector("#edit-modal"),i=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),d=l.querySelector("#profile-name-input"),m=l.querySelector("#profile-description-input"),p=document.querySelector(".profile__edit-btn"),f=document.forms["edit-profile"];p.addEventListener("click",(()=>{[d,m].forEach((e=>n(e,t))),E(),k(l)})),f.addEventListener("submit",(function(e){e.preventDefault(),i.textContent=d.value,u.textContent=m.value,L(l)}));const _=document.querySelector("#new-post-modal"),y=_.querySelector("#post-image-link-input"),v=_.querySelector("#post-name-input"),S=document.querySelector(".profile__add-btn"),g=document.forms["new-post"],b=g.querySelector(".modal__submit-btn");S.addEventListener("click",(()=>k(_))),g.addEventListener("submit",(function(e){e.preventDefault();const o=y.value,n=v.value;e.target.reset();const c=A({link:o,name:n});a.prepend(c),L(_),r(b,t)}));const h=document.querySelector("#preview-modal"),q=h.querySelector(".modal__image"),w=h.querySelector(".modal__caption");function E(){d.value=i.textContent,m.value=u.textContent}function k(e){document.addEventListener("keydown",C),e.classList.add("modal_opened")}function L(e){document.removeEventListener("keydown",C),e.classList.remove("modal_opened")}function C(e){"Escape"===e.key&&document.querySelectorAll(".modal_opened").forEach(L)}function A(e){let{link:t,name:o}=e;const n=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),r=n.querySelector(".card__title"),c=n.querySelector(".card__image"),s=n.querySelector(".card__like-btn"),a=n.querySelector(".card__delete-btn");return r.textContent=o,c.setAttribute("src",t),c.setAttribute("alt",o+" image"),s.addEventListener("click",(()=>s.classList.toggle("card__like-btn_is-liked"))),a.addEventListener("click",(()=>n.remove())),c.addEventListener("click",(()=>{q.setAttribute("src",t),q.setAttribute("alt",o+" image"),w.textContent=o,k(h)})),n}var x;document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>L(t)))})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&L(e.target)}))})),E(),[{name:"Golden Gate bridge",link:"  https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach((e=>{const t=A(e);a.append(t)})),x=t,document.querySelectorAll(x.formSelector).forEach((e=>{!function(e,t){const r=e.querySelectorAll(t.inputSelector),c=e.querySelector(t.submitBtnSelector);o(r,c,t),r.forEach((e=>{e.addEventListener("input",(()=>{!function(e,t){e.validity.valid?n(e,t):function(e,t){const o=e.parentElement.querySelector(t.errorSelector);e.classList.add(t.inputTypeErrorClass),o.textContent=e.validationMessage,o.classList.add(t.errorActiveClass)}(e,t)}(e,t),o(r,c,t)}))}))}(e,x)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ0blNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBlcnJvclNlbGVjdG9yOiBcIi5tb2RhbF9fZXJyb3JcIixcbiAgaW5wdXRUeXBlRXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckFjdGl2ZUNsYXNzOiBcIm1vZGFsX19lcnJvcl9hY3RpdmVcIixcbiAgaW5hY3RpdmVTdWJtaXRCdG5DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9pbmFjdGl2ZVwiLFxufVxuXG5mdW5jdGlvbiBlbmFibGVWYWxpZGF0aW9uKGNvbmZpZykge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XG5cbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0VmFsaWRhdGlvbk9uRXZlbnQoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc2V0VmFsaWRhdGlvbk9uRXZlbnQoZm9ybUVsLCBjb25maWcpIHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpO1xuICBjb25zdCBidXR0b25FbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdG5TZWxlY3Rvcik7XG5cbiAgdXBkYXRlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIHRvZ2dsZUlucHV0RXJyb3IoaW5wdXRFbCwgY29uZmlnKTtcbiAgICAgIHVwZGF0ZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpIHtcbiAgY29uc3QgaGFzSW52YWxpZElucHV0ID0gKCgpID0+IHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShpbnB1dExpc3QpLnNvbWUoKGlucHV0RWwpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfSkoKTtcblxuICBpZiAoaGFzSW52YWxpZElucHV0KSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBlbmFibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsLCBjb25maWcpIHtcbiAgaWYgKGlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBoaWRlSW5wdXRFcnJvcihpbnB1dEVsLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIHNob3dJbnB1dEVycm9yKGlucHV0RWwsIGNvbmZpZyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGlkZUlucHV0RXJyb3IoaW5wdXRFbCwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWwgPSBpbnB1dEVsLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuZXJyb3JTZWxlY3Rvcik7XG5cbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dFR5cGVFcnJvckNsYXNzKTtcbiAgZXJyb3JFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckFjdGl2ZUNsYXNzKTtcbn1cblxuZnVuY3Rpb24gc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWwgPSBpbnB1dEVsLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuZXJyb3JTZWxlY3Rvcik7XG5cbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dFR5cGVFcnJvckNsYXNzKTtcbiAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gIGVycm9yRWwuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JBY3RpdmVDbGFzcyk7XG59XG5cbmZ1bmN0aW9uIGRpc2FibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZykge1xuICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZVN1Ym1pdEJ0bkNsYXNzKTtcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBlbmFibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZykge1xuICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZVN1Ym1pdEJ0bkNsYXNzKTtcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcbn1cblxuZnVuY3Rpb24gcmVzZXRWYWxpZGF0aW9uKGlucHV0TGlzdCkge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4gaGlkZUlucHV0RXJyb3IoaW5wdXRFbCwgZm9ybVZhbGlkYXRpb25Db25maWcpKTtcbn1cblxuZXhwb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgcmVzZXRWYWxpZGF0aW9uLCBkaXNhYmxlQnV0dG9uLCBmb3JtVmFsaWRhdGlvbkNvbmZpZyB9OyIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICByZXNldFZhbGlkYXRpb24sXG4gIGRpc2FibGVCdXR0b24sXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgbG9nb1NyYyBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XG5pbXBvcnQgYXZhdGFyU3JjIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xuXG5jb25zdCBsb2dvSW1hZ2VFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9nb1wiKTtcbmxvZ29JbWFnZUVsLnNyYyA9IGxvZ29TcmM7XG5jb25zdCBhdmF0YXJJbWFnZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXJcIik7XG5hdmF0YXJJbWFnZUVsLnNyYyA9IGF2YXRhclNyYztcblxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBicmlkZ2VcIixcbiAgICBsaW5rOiBcIiAgaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbl07XG5cbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbi8vIHByb2ZpbGUgZWRpdFxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xuXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICByZXNldFZhbGlkYXRpb24oW3Byb2ZpbGVOYW1lSW5wdXQsIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0XSk7XG4gIHNldFByb2ZpbGVGb3JtVmFsdWVzKCk7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xufSk7XG5wcm9maWxlRWRpdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQpO1xuXG4vLyBuZXcgcG9zdFxuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcbmNvbnN0IG5ld1Bvc3RJbWFnZUxpbmtJbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwb3N0LWltYWdlLWxpbmstaW5wdXRcIlxuKTtcbmNvbnN0IG5ld1Bvc3ROYW1lSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwb3N0LW5hbWUtaW5wdXRcIik7XG5jb25zdCBuZXdQb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xuY29uc3QgbmV3UG9zdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm5ldy1wb3N0XCJdO1xuY29uc3QgcG9zdFN1Ym1pdEJ0biA9IG5ld1Bvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5cbm5ld1Bvc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpKTtcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlTmV3UG9zdFN1Ym1pdCk7XG5cbi8vIHByZXZpZXdcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgY2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbi8vIGNsb3NlIG1vZGFsIGJ0bnMgbGlzdGVuZXJzXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgY29uc3QgbW9kYWwgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsKSk7XG59KTtcblxuLy8gY2xvc2UgbW9kYWxzIG9uIG92ZXJsYXkgY2xpY2tcblxuY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcblxubW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgY2xvc2VNb2RhbChldmVudC50YXJnZXQpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gZnVuY3Rpb25zXG5cbmZ1bmN0aW9uIHNldFByb2ZpbGVGb3JtVmFsdWVzKCkge1xuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xufVxuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9uRXNjYXBlKTtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsT25Fc2NhcGUpO1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xufVxuXG5mdW5jdGlvbiBjbG9zZU1vZGFsT25Fc2NhcGUoZXZlbnQpIHtcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIG1vZGFscy5mb3JFYWNoKGNsb3NlTW9kYWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlRm9ybVN1Ym1pdChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gcHJvZmlsZU5hbWVJbnB1dC52YWx1ZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG5cbiAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVOZXdQb3N0U3VibWl0KGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGxpbmsgPSBuZXdQb3N0SW1hZ2VMaW5rSW5wdXQudmFsdWU7XG4gIGNvbnN0IG5hbWUgPSBuZXdQb3N0TmFtZUlucHV0LnZhbHVlO1xuICBldmVudC50YXJnZXQucmVzZXQoKTtcblxuICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudCh7XG4gICAgbGluayxcbiAgICBuYW1lLFxuICB9KTtcblxuICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWwpO1xuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG4gIGRpc2FibGVCdXR0b24ocG9zdFN1Ym1pdEJ0biwgZm9ybVZhbGlkYXRpb25Db25maWcpO1xufVxuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudCh7IGxpbmssIG5hbWUgfSkge1xuICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBuYW1lO1xuICBjYXJkSW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbGluayk7XG4gIGNhcmRJbWFnZUVsLnNldEF0dHJpYnV0ZShcImFsdFwiLCBuYW1lICsgXCIgaW1hZ2VcIik7XG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9pcy1saWtlZFwiKVxuICApO1xuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjYXJkRWxlbWVudC5yZW1vdmUoKSk7XG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIGxpbmspO1xuICAgIHByZXZpZXdJbWFnZUVsLnNldEF0dHJpYnV0ZShcImFsdFwiLCBuYW1lICsgXCIgaW1hZ2VcIik7XG4gICAgY2FwdGlvbkVsLnRleHRDb250ZW50ID0gbmFtZTtcblxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbml0aWFsQ2FyZHMoKSB7XG4gIGluaXRpYWxDYXJkcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmRFbCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcbiAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbCk7XG4gIH0pO1xufVxuXG5zZXRQcm9maWxlRm9ybVZhbHVlcygpO1xubG9hZEluaXRpYWxDYXJkcygpO1xuZW5hYmxlVmFsaWRhdGlvbihmb3JtVmFsaWRhdGlvbkNvbmZpZyk7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImZvcm1WYWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ0blNlbGVjdG9yIiwiZXJyb3JTZWxlY3RvciIsImlucHV0VHlwZUVycm9yQ2xhc3MiLCJlcnJvckFjdGl2ZUNsYXNzIiwiaW5hY3RpdmVTdWJtaXRCdG5DbGFzcyIsInVwZGF0ZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJjb25maWciLCJBcnJheSIsImZyb20iLCJzb21lIiwiaW5wdXRFbCIsInZhbGlkaXR5IiwidmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiZGlzYWJsZWQiLCJlbmFibGVCdXR0b24iLCJoaWRlSW5wdXRFcnJvciIsImVycm9yRWwiLCJwYXJlbnRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJsb2dvU3JjIiwiYXZhdGFyU3JjIiwiY2FyZHNMaXN0IiwiZWRpdE1vZGFsIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEJ0biIsInByb2ZpbGVFZGl0Rm9ybSIsImZvcm1zIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvckVhY2giLCJzZXRQcm9maWxlRm9ybVZhbHVlcyIsIm9wZW5Nb2RhbCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ0ZXh0Q29udGVudCIsInZhbHVlIiwiY2xvc2VNb2RhbCIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RJbWFnZUxpbmtJbnB1dCIsIm5ld1Bvc3ROYW1lSW5wdXQiLCJuZXdQb3N0QnRuIiwibmV3UG9zdEZvcm0iLCJwb3N0U3VibWl0QnRuIiwibGluayIsIm5hbWUiLCJ0YXJnZXQiLCJyZXNldCIsImNhcmRFbCIsImdldENhcmRFbGVtZW50IiwicHJlcGVuZCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdJbWFnZUVsIiwiY2FwdGlvbkVsIiwibW9kYWwiLCJjbG9zZU1vZGFsT25Fc2NhcGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwicXVlcnlTZWxlY3RvckFsbCIsIl9yZWYiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJzZXRBdHRyaWJ1dGUiLCJ0b2dnbGUiLCJidXR0b24iLCJjbG9zZXN0IiwiY29udGFpbnMiLCJjYXJkRGF0YSIsImFwcGVuZCIsImZvcm1FbCIsInZhbGlkYXRpb25NZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJ0b2dnbGVJbnB1dEVycm9yIiwic2V0VmFsaWRhdGlvbk9uRXZlbnQiXSwic291cmNlUm9vdCI6IiJ9